import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as b,r as i,j as t,T as c,N as f,b as y,I as X,h as z,f as p,A as Z,i as D,d as S,M as ge,g as he,R as fe}from"./theme-BJTjYQlA.js";import{a as R}from"./auth-DmuFIzIA.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],me=b("loader-circle",pe);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],ye=b("log-out",xe);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],be=b("monitor",Se);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],Re=b("panel-right-close",ve);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],je=b("panel-right-open",Ee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ke=b("square",Te),E="rgba(255,255,255,0.04)",j="rgba(255, 0, 122, 0.25)";var Y;const Q=typeof chrome<"u"&&((Y=chrome.runtime)!=null&&Y.getURL)?chrome.runtime.getURL("logo.svg"):"/logo.svg";function Ce(l){const u=Math.floor(l/3600),m=Math.floor(l%3600/60),g=l%60;return u>0?`${String(u).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(g).padStart(2,"0")}`:`${String(m).padStart(2,"0")}:${String(g).padStart(2,"0")}`}function Ie(){var K,F;const[l,u]=i.useState(null),[m,g]=i.useState(!0),[J,_]=i.useState(!1),[L,ee]=i.useState(""),[P,te]=i.useState(""),[$,G]=i.useState(""),[d,T]=i.useState("PROGRAMMED"),[I,x]=i.useState(null),[ne,B]=i.useState(0),[k,ie]=i.useState([]),[w,U]=i.useState(null),[W,M]=i.useState(!1),[re,q]=i.useState(!1),[we,H]=i.useState(null),[V,v]=i.useState(!1),h=i.useRef(null),oe=[{value:"CONVERTED",label:"Venda realizada"},{value:"LOST",label:"Venda perdida"},{value:"FOLLOW_UP",label:"Em negociação"},{value:"UNKNOWN",label:"A definir"}];i.useEffect(()=>{let e=!1;const r=a=>{e||a&&(e=!0,_(!0),g(!1),u(a),R.restoreSessionInMemory(a).catch(()=>{}))},n=()=>{e||(e=!0,_(!0),u(null),g(!1))},s=a=>{(a==null?void 0:a.type)==="SESSION_RESULT"&&r(a.session??null)};chrome.runtime.onMessage.addListener(s),se(),R.getSession().then(a=>{a&&r(a)}).catch(()=>{});const A=setTimeout(n,3e3);return()=>{clearTimeout(A),chrome.runtime.onMessage.removeListener(s)}},[]),i.useEffect(()=>{const e=(r,n)=>{n==="local"&&r.sidebarOpen!=null&&M(!!r.sidebarOpen.newValue)};return chrome.storage.onChanged.addListener(e),()=>chrome.storage.onChanged.removeListener(e)},[]),i.useEffect(()=>{chrome.tabs.query({active:!0,currentWindow:!0},([e])=>{if(!(e!=null&&e.id)||!e.url){q(!1),H(null);return}H(e.id);const r=e.url.toLowerCase(),n=r.includes("meet.google.com")||r.includes("zoom.us");q(n),n&&chrome.tabs.sendMessage(e.id,{type:"GET_SIDEBAR_OPEN"},s=>{chrome.runtime.lastError||s&&typeof s.open=="boolean"&&M(s.open)})})},[]);const C=i.useCallback(()=>{chrome.runtime.sendMessage({type:"GET_STATUS"},e=>{((e==null?void 0:e.status)==="RECORDING"||(e==null?void 0:e.status)==="PROGRAMMED"||(e==null?void 0:e.status)==="PAUSED")&&T(e.status),(e==null?void 0:e.recordingStartedAt)!=null?x(e.recordingStartedAt):x(null)})},[]);i.useEffect(()=>{C()},[C]),i.useEffect(()=>{const e=()=>{document.visibilityState==="visible"&&C()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[C]),i.useEffect(()=>{if(d==="RECORDING"&&I!=null){const e=()=>{B(Math.floor((Date.now()-I)/1e3))};return e(),h.current=setInterval(e,1e3),()=>{h.current&&clearInterval(h.current),h.current=null}}else B(0),h.current&&(clearInterval(h.current),h.current=null)},[d,I]),i.useEffect(()=>{!l||d==="RECORDING"||chrome.tabs.query({currentWindow:!0},e=>{const r=e.filter(n=>n.id!=null&&n.url&&(n.url.startsWith("http://")||n.url.startsWith("https://"))).map(n=>({id:n.id,title:n.title||n.url||"Aba",url:n.url||""}));ie(r),r.length>0&&w===null&&chrome.tabs.query({active:!0,currentWindow:!0},([n])=>{const s=r.find(A=>A.id===(n==null?void 0:n.id));U(s?s.id:r[0].id)})})},[l,d]);const se=()=>{chrome.runtime.sendMessage({type:"GET_SESSION"}).catch(()=>{})},ae=async e=>{e.preventDefault(),g(!0),G("");try{await R.login(L,P);const r=await R.getSession();u(r)}catch(r){G(r.message)}finally{g(!1)}},le=async()=>{await R.logout(),u(null)},N=async e=>{var n,s;const r=d==="RECORDING"?void 0:w??((n=k[0])==null?void 0:n.id)??((s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0])==null?void 0:s.id);if(d==="RECORDING"){if(e===void 0){v(!0);return}v(!1),T("PROGRAMMED"),x(null),chrome.runtime.sendMessage({type:"STOP_CAPTURE",result:e})}else T("RECORDING"),x(Date.now()),chrome.runtime.sendMessage({type:"START_CAPTURE",tabId:r??void 0})},de=e=>{e.preventDefault(),e.stopPropagation(),d==="RECORDING"?v(!0):N()},ce=e=>{N(e)},ue=()=>{chrome.runtime.sendMessage({type:"TOGGLE_SUGGESTIONS_PANEL"},()=>{chrome.runtime.lastError||M(e=>!e)})};i.useEffect(()=>{const e=r=>{r.type==="STATUS_UPDATE"&&(T(r.status),r.status!=="RECORDING"?x(null):chrome.runtime.sendMessage({type:"GET_STATUS"},n=>{(n==null?void 0:n.recordingStartedAt)!=null&&x(n.recordingStartedAt)}))};return chrome.runtime.onMessage.addListener(e),()=>chrome.runtime.onMessage.removeListener(e)},[]);const O={width:"100%",height:"100%",minHeight:0,color:c,fontFamily:"system-ui, -apple-system, sans-serif",position:"relative",zIndex:1,padding:"12px 10px",boxSizing:"border-box",overflow:V?"visible":"hidden",display:"flex",flexDirection:"column"};if(!J||m)return t.jsx("div",{style:{...O,display:"flex",alignItems:"center",justifyContent:"center",padding:40},children:t.jsx(me,{size:28,style:{color:f},className:"animate-spin"})});if(!l)return t.jsxs("div",{style:{...O,padding:24,alignItems:"center",justifyContent:"flex-start"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:20},children:t.jsx("img",{src:Q,alt:"HelpSeller",style:{height:48,width:"auto"}})}),t.jsx("h2",{style:{fontSize:16,fontWeight:600,marginBottom:6,color:c,letterSpacing:"-0.02em",textAlign:"center"},children:"Bem-vindo ao HelpSeller"}),t.jsx("p",{style:{fontSize:12,color:y,marginBottom:20,textAlign:"center",lineHeight:1.4},children:"Faça login para usar o coach de vendas em tempo real nas suas reuniões."}),t.jsxs("form",{onSubmit:ae,style:{display:"flex",flexDirection:"column",gap:14,width:"100%"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:11,fontWeight:500,marginBottom:4,color:y},children:"Email"}),t.jsx("input",{type:"email",value:L,onChange:e=>ee(e.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:p,border:`1px solid ${z}`,background:X,color:c,fontSize:13,boxSizing:"border-box"},required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:11,fontWeight:500,marginBottom:4,color:y},children:"Senha"}),t.jsx("input",{type:"password",value:P,onChange:e=>te(e.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:p,border:`1px solid ${z}`,background:X,color:c,fontSize:13,boxSizing:"border-box"},required:!0})]}),$&&t.jsx("p",{style:{color:Z,fontSize:12},children:$}),t.jsx("button",{type:"submit",disabled:m,style:{width:"100%",padding:12,borderRadius:p,border:"none",background:`linear-gradient(135deg, ${f}, ${D})`,color:"white",fontSize:13,fontWeight:600,cursor:"pointer"},children:m?"Entrando...":"Entrar"})]})]});const o=d==="RECORDING";return t.jsxs("div",{style:O,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4,flexShrink:0},children:[t.jsx("img",{src:Q,alt:"HelpSeller",style:{height:20,width:"auto"}}),t.jsx("button",{onClick:le,style:{background:"none",border:"none",color:S,cursor:"pointer",padding:2},"aria-label":"Sair",children:t.jsx(ye,{size:14})})]}),t.jsx("p",{style:{fontSize:10,color:y,marginBottom:10},children:(K=l.user)==null?void 0:K.email}),re&&t.jsx("div",{style:{marginBottom:10},children:t.jsxs("button",{type:"button",onClick:ue,style:{display:"flex",alignItems:"center",gap:6,width:"100%",padding:"8px 10px",borderRadius:p,border:`1px solid ${j}`,background:E,color:c,fontSize:11,fontWeight:500,cursor:"pointer"},children:[W?t.jsx(Re,{size:14}):t.jsx(je,{size:14}),W?"Ocultar painel de sugestões":"Mostrar painel de sugestões"]})}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:12,padding:"6px 10px",borderRadius:16,background:E,border:`1px solid ${j}`,width:"fit-content",flexShrink:0},children:[t.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:o?f:S,animation:o?"record-dot 1.2s ease-in-out infinite":void 0}}),t.jsx("span",{style:{fontSize:10,fontWeight:600,color:o?f:y,textTransform:"uppercase",letterSpacing:"0.06em"},children:o?"Gravando":"Parado"})]}),t.jsxs("div",{style:{textAlign:"center",marginBottom:14,padding:"12px 10px",borderRadius:12,background:E,border:`1px solid ${j}`,flexShrink:0},children:[t.jsx("div",{style:{fontSize:10,color:S,marginBottom:2,textTransform:"uppercase",letterSpacing:"0.08em"},children:"Tempo de gravação"}),t.jsx("div",{style:{fontSize:32,fontWeight:700,fontVariantNumeric:"tabular-nums",color:o?"#fff":S,textShadow:o?`0 0 20px ${f}40`:void 0,letterSpacing:"0.02em"},children:o?Ce(ne):"00:00"})]}),!o&&k.length>0&&t.jsxs("div",{style:{marginBottom:12},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:10,fontWeight:500,marginBottom:4,color:y},children:[t.jsx(be,{size:12}),"Aba"]}),t.jsx("select",{value:w??((F=k[0])==null?void 0:F.id)??"",onChange:e=>U(Number(e.target.value)||null),style:{width:"100%",padding:"8px 10px",borderRadius:p,border:`1px solid ${j}`,background:E,color:c,fontSize:11,boxSizing:"border-box"},children:k.map(e=>t.jsx("option",{value:e.id,children:e.title.length>32?e.title.slice(0,32)+"…":e.title},e.id))})]}),t.jsx("div",{style:{display:"flex",justifyContent:"center",flexShrink:0},children:t.jsx("button",{type:"button",onClick:o?de:()=>N(),style:{width:64,height:64,borderRadius:"50%",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:o?`linear-gradient(135deg, ${Z}, #b91c1c)`:`linear-gradient(135deg, ${f}, ${D})`,color:"white",boxShadow:o?"0 0 20px rgba(220, 38, 62, 0.5), 0 0 40px rgba(220, 38, 62, 0.2)":`0 0 24px ${f}50, 0 0 48px ${D}30`,animation:o?"neon-pulse-stop 2s ease-in-out infinite":"neon-pulse 2s ease-in-out infinite",transition:"transform 0.15s ease"},onMouseDown:e=>e.currentTarget.style.transform="scale(0.95)",onMouseUp:e=>e.currentTarget.style.transform="scale(1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:o?t.jsx(ke,{size:24,fill:"currentColor"}):t.jsx(ge,{size:24})})}),t.jsx("p",{style:{textAlign:"center",fontSize:10,color:S,marginTop:8},children:o?"Clique para parar":"Clique para iniciar"}),V&&t.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"result-modal-title",style:{position:"fixed",top:0,left:0,right:0,bottom:0,minHeight:"100%",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:16,boxSizing:"border-box"},onClick:()=>v(!1),children:t.jsxs("div",{style:{background:"rgba(30,30,30,0.98)",border:`1px solid ${j}`,borderRadius:16,padding:20,width:"100%",maxWidth:320},onClick:e=>e.stopPropagation(),children:[t.jsx("p",{id:"result-modal-title",style:{fontSize:13,fontWeight:600,color:c,marginBottom:16,textAlign:"center"},children:"Qual foi o resultado desta chamada?"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:oe.map(e=>t.jsx("button",{type:"button",onClick:()=>ce(e.value),style:{width:"100%",padding:"12px 14px",borderRadius:p,border:`1px solid ${z}`,background:E,color:c,fontSize:12,fontWeight:500,cursor:"pointer",textAlign:"left"},children:e.label},e.value))}),t.jsx("button",{type:"button",onClick:()=>v(!1),style:{marginTop:12,width:"100%",padding:10,borderRadius:p,border:"none",background:"transparent",color:S,fontSize:11,cursor:"pointer"},children:"Cancelar"})]})})]})}he.createRoot(document.getElementById("root")).render(t.jsx(fe.StrictMode,{children:t.jsx(Ie,{})}));
